# 修改蓝牙协议帧结构

## 需求分析

用户要求将协议帧中的`len`字段移到`feature`字段之前，并更新长度计算规则，使其包含通道+id的长度。

## 当前帧结构

```cpp
typedef struct {
    uint8_t head;            // 1 byte, 固定为 0xFE
    uint8_t sync;           // 1 byte, 下发包为 0xAB，回包为 0xBA
    uint16_t feature;       // 2 bytes, 通道字段（大端）
    uint16_t id;            // 2 bytes, 命令 ID（大端）
    uint16_t len;           // 2 bytes, 长度（大端）
    uint8_t *data;          // n bytes, 数据载荷
    uint16_t crc;           // 2 bytes, CRC16（大端）
    uint8_t end[2];         // 2 bytes, 固定为 0x0A0D
} BleFrame_t;
```

## 修改内容

### 1. 更新协议文档

* 修改`通用蓝牙协议.md`文件中的帧结构定义，将`len`字段移到`feature`字段之前
* 更新长度计算规则，从`len = id(2B) + data_len`改为`len = feature(2B) + id(2B) + data_len`

### 2. 确保代码实现与文档一致

* 验证当前代码实现是否已经按照要求修改
* 如果需要，更新代码中的相关注释和文档

### 3. 测试和验证

* 确保修改后的帧结构能够正确构建和解析
* 验证长度计算规则的正确性
* 确保所有功能正常工作

## 预期结果

* 协议文档与代码实现保持一致
* 帧结构中`len`字段位于`feature`字段之前
* 长度计算包含通道+id的长度
* 所有功能正常工作